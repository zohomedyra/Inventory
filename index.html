<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Inventory + Batch + Committed Dashboard</title>

  <link rel="stylesheet" href="style.css"/>

  <!-- Libraries (defer) -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js" defer></script>
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js" defer></script>
  <!-- App JS -->
  <script src="app.js" defer></script>
</head>
<body>

<header class="row">
  <h1>ðŸ“¦ Inventory + ðŸ§ª Batch + ðŸ“‘ Committed</h1>
  <label class="file">Inventory Summary <input id="fileInv" type="file" accept=".xlsx,.xls,.csv"/></label>
  <label class="file">Batch Details <input id="fileBatch" type="file" accept=".xlsx,.xls,.csv"/></label>
  <label class="file">Committed Details <input id="fileCommitted" type="file" accept=".xlsx,.xls,.csv"/></label>
  <div id="status" class="muted"></div>
</header>

<!-- KPI Cards -->
<section class="panel">
  <div class="section-bar bar-glance">Total at a glance</div>
  <div class="cards">
    <div class="card purple">
      <div class="title">Total SKUs (Inventory)</div>
      <div class="val" id="kpiSKUs">â€”</div>
    </div>
    <div class="card blue">
      <div class="title">Total Stock On Hand</div>
      <div class="val" id="kpiSOH">â€”</div>
    </div>
    <div class="card green">
      <div class="title">Inventory Value</div>
      <div class="val" id="kpiInvValue">â€”</div>
    </div>
    <div class="card orange">
      <div class="title">Mismatched SKUs</div>
      <div class="val" id="kpiMismatch">â€”</div>
    </div>
  </div>
</section>

<!-- Stock Check -->
<section class="panel stockcheck">
  <div class="section-bar bar-stock">Stock Check</div>

  <div class="row center">
    <div>
      <div class="muted">Category</div>
      <select id="scCategory" style="min-width:240px"></select>
    </div>
    <div>
      <div class="muted">Product (Sales Description)</div>
      <select id="scProduct" style="min-width:420px"></select>
      <div id="scProductSub" class="muted small"></div>
    </div>
  </div>

  <div class="cards center" id="scCards" style="display:none">
    <div class="card wide gray"><div class="title">Product</div><div class="val" id="lkProduct">â€”</div></div>
    <div class="card blue"><div class="title">Stock On Hand</div><div class="val" id="lkSOH">â€”</div></div>
    <div class="card rose"><div class="title">Committed Stock</div><div class="val" id="lkCommitted">â€”</div></div>
    <div class="card teal"><div class="title">Available for Sale</div><div class="val" id="lkAvail">â€”</div></div>
    <div class="card green"><div class="title">Stock Value (SOH Ã— Price)</div><div class="val" id="lkValue">â€”</div></div>
  </div>

  <!-- Committed for selected product -->
  <div id="lookupCommitted" class="centered-block" style="margin-top:10px"></div>

  <!-- Batches for selected product -->
  <div id="lookupBatches" class="centered-block" style="margin-top:10px"></div>
</section>

<!-- Category-wise Stock Value -->
<section class="panel">
  <div class="section-bar bar-category">Category-wise Stock Value</div>
  <div id="stockByCategory" style="height:380px"></div>
</section>

<!-- Top products -->
<section class="panel">
  <div class="section-bar bar-top">Top products by Stock Value</div>
  <div id="topProducts" style="height:380px"></div>
</section>

<!-- Zero Stock (Medyra Onco) -->
<section class="panel">
  <div class="section-bar bar-zero">Zero Stock â€” Medyra Onco</div>
  <div id="zeroStockTable" class="box"></div>
</section>

<!-- Mismatch list -->
<section class="panel">
  <div class="section-bar bar-mismatch">Mismatched SKU details (|Batch âˆ’ Inventory| &gt; 1)</div>
  <div id="mismatchTable" class="box"></div>
</section>

<!-- Expiry -->
<section class="panel">
  <div class="section-bar bar-expiry">Expiry analysis (expires in &lt; 11 months)</div>
  <div id="expiryTable" class="box"></div>
</section>

<!-- Committed Items by Customer -->
<section class="panel">
  <div class="section-bar bar-committed">Committed Items (by Customer)</div>
  <div class="row center" style="margin-bottom:6px">
    <div class="muted">Customer</div>
    <select id="commitCustomerFilter" style="min-width:300px"></select>
  </div>
  <div id="commitItemsTable" class="box"></div>
</section>

<!-- Raw details -->
<section class="panel">
  <div class="section-bar bar-details">Details (first 2000 Inventory rows)</div>
  <div class="row center" style="margin-bottom:6px">
    <div class="muted">Filter by Category</div>
    <select id="detailCat" style="min-width:240px"></select>
  </div>
  <div id="table" class="box"></div>
</section>

<footer class="muted small">All processing happens in your browser. Files are not uploaded.</footer>
</body>
</html>